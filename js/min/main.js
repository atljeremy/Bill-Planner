/*
Deliverable 1
Author: Jeremy Fox
Created For: MiU Online
Simple HTML5 / Javascript Mobile Web Form
*//*
Variables
*/((function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this;this.dataViewState=!1;this.hasDataBeenDisplayed=!1;this.invalidateData=!1;this.keyToEdit=0;b=["-- Choose Account --","Bank of America - Checking","Bank of America - Savings","Bank of America - Credit Card"];r=function(a){return A.dataViewState=a};l=function(){return A.dataViewState};p=function(a){return A.hasDataBeenDisplayed=a};i=function(){return A.hasDataBeenDisplayed};q=function(a){return A.invalidateData=a};k=function(){return A.invalidateData};e=function(){return $("#items").empty()};this.getKeyToEdit=function(){return A.keyToEdit};this.setKeyToEdit=function(a){return A.keyToEdit=a};this.storeData=function(){var a,b,c,d,e;e=new Date;A.getKeyToEdit()===0||A.getKeyToEdit()===""?b=e.getTime():b=A.getKeyToEdit();d=x();if(!_.isEmpty(d)){c=d.join("\n");return alert(c)}a={};a.name=["Name:",$("#name").val()];a.payto=["Pay To:",$("#payTo").val()];a.amount=["Amount:",$("#payAmount").val()];a.account=["From Account:",$("#payFrom").val()];a.payon=["Pay On:",$("#payOn").val()];a.notes=["Notes:",$("#notes").val()];a.remember=["Remember This Payment:",j()];try{localStorage.setItem(b,JSON.stringify(a));q(!0);alert("Bill Added!");A.setKeyToEdit(0);$("legend").html("<h2>Create a New Bill</h2>");A.displayData()}catch(f){return alert(f)}};u=function(){_.each(_.keys(A.json),function(a){var b;b=this.json[a];try{localStorage.setItem(a,JSON.stringify(b))}catch(c){return alert(c)}});q(!0);return h()};h=function(){return _.size(localStorage)>0?o(localStorage,"localStorage"):u()};o=function(a,b){var c;c=document.createElement("ul");$("#items").append(c);_.each(_.keys(a),function(e){var g,h,i,j,k,l,m,n,o,p;n=document.createElement("li");c.appendChild(n);b==="localStorage"?p=a.getItem(e):p=a[e];b==="localStorage"?j=JSON.parse(p):j=p;o=document.createElement("ul");o.setAttribute("class","bill");o.setAttribute("id","bill-"+e);m=document.createElement("img");m.setAttribute("src","i/pencil.png");m.setAttribute("class","icons");m.setAttribute("id","edit-"+e);l=document.createElement("img");l.setAttribute("src","i/x.png");l.setAttribute("class","icons");l.setAttribute("id","delete-"+e);k=document.createElement("img");g=/((Checking)|(Savings)|(Credit\sCard))+/g;h=j.account[1];i=h.match(g);switch(i[0]){case"Checking":k.setAttribute("src","i/thumb_checking.png");break;case"Savings":k.setAttribute("src","i/thumb_savings.png");break;case"Credit Card":k.setAttribute("src","i/thumb_creditcard.png")}k.setAttribute("class","icons");k.setAttribute("id","account-"+e);o.appendChild(m);o.appendChild(l);o.appendChild(k);n.appendChild(o);$("#edit-"+e).click("click",function(a){return f(e)});$("#delete-"+e).click("click",function(a){return d(e)});$("#account-"+e).click("click",function(a){return s(e)});_.each(j,function(a){var b,c;c=document.createElement("li");a[0]==="From Account:"&&c.setAttribute("id","li-account-"+e);o.appendChild(c);b=document.createElement("span");p=document.createElement("span");b.setAttribute("class","billField");p.setAttribute("class","billValue");c.appendChild(b);c.appendChild(p);b.innerHTML=a[0]+" ";p.innerHTML=a[1];return!0});return!0});return!0};f=function(a){var b,c,d,e,f,g,h;e=localStorage.getItem(a);b=JSON.parse(e);A.setKeyToEdit(a);$("legend").html('<h2>Your Editing a Bill - <a href="additem.html" data-ajax="false" >Cancel</a></h2>');A.displayData();document.getElementById("name").value=b.name[1];document.getElementById("payTo").value=b.payto[1];document.getElementById("payAmount").value=b.amount[1];document.getElementById("payFrom").value=b.account[1];document.getElementById("payOn").value=b.payon[1];document.getElementById("notes").value=b.notes[1];d=document.forms[0].remember;h=[];for(f=0,g=d.length;f<g;f++){c=d[f];if(c.value==="Yes"&&b.remember[1]==="Yes"){c.setAttribute("checked","checked");document.getElementById("labelNo").setAttribute("class","ui-btn ui-corner-right ui-controlgroup-last ui-radio-off ui-btn-up-c");h.push(document.getElementById("labelYes").setAttribute("class","ui-btn ui-corner-left ui-btn-up-c ui-radio-on ui-btn-active"))}else if(c.value==="No"&&b.remember[1]==="No"){c.setAttribute("checked","checked");document.getElementById("labelYes").setAttribute("class","ui-btn ui-radio-off ui-corner-left ui-btn-up-c");h.push(document.getElementById("labelNo").setAttribute("class","ui-btn ui-corner-right ui-controlgroup-last ui-radio-on ui-btn-active ui-btn-up-c"))}else h.push(void 0)}return h};d=function(a){var b;b=confirm("Are you sure you want to delete this bill?");if(!b)return alert("Bill was not deleted");$("#bill-"+a).animate({opacity:0,height:"toggle"},1e3);if(_.size(localStorage)>1){localStorage.removeItem(a);return q(!0)}if(_.size(localStorage)===1){localStorage.removeItem(a);q(!0);return setTimeout(function(){return this.displayData()},1e3)}};s=function(a){return $("#li-account-"+a).animate({opacity:0},500,function(){return $("#li-account-"+a).animate({opacity:1},500,function(){})})};this.addAccount=function(a){};this.clearStorage=function(){localStorage.clear();return alert("All Data Has Been Deleted.")};$("#billForm").live("submit",function(a){var b;t(a);b=$(this).serialize();$.ajax({type:"POST",url:"additem.html",data:b,success:function(){return storeData()}});return!1});$("#billSearch").click("click",function(a){$("#searchFormContainer").css("display","block");$("#searchFormContainer").animate({opacity:1},1e3);$("#billSearch").animate({opacity:0},500);setTimeout(function(){return $("#billSearch").css("display","none")},500);return setTimeout(function(){$("#billSearchHide").css("display","inline");return $("#billSearchHide").animate({opacity:1},500)},500)});$("#billSearchHide").click("click",function(a){$("#searchFormContainer").animate({opacity:0},1e3);setTimeout(function(){return $("#searchFormContainer").css("display","none")},1e3);$("#billSearchHide").animate({opacity:0},500);setTimeout(function(){return $("#billSearchHide").css("display","none")},500);return setTimeout(function(){$("#billSearch").css("display","inline");return $("#billSearch").animate({opacity:1},500)},500)});$("#viewBills").click("click",function(a){t(a);setTimeout(function(){return this.displayData(!0,!1)},500);return $.mobile.changePage("additem.html",{transition:"slideup",showLoadMsg:!0})});$("#addBill").click("click",function(a){t(a);setTimeout(function(){return this.displayData(!1,!0)},500);return $.mobile.changePage("additem.html",{showLoadMsg:!0})});$("#cta-bills").click("click",function(a){t(a);setTimeout(function(){return this.displayData(!1,!0)},500);return $.mobile.changePage("additem.html",{showLoadMsg:!0})});a=function(a){return a<10?"0"+a:""+a};j=function(){var a,b,c,d,e;b=document.forms[0].remember;for(d=0,e=b.length;d<e;d++){a=b[d];if(a.checked){c="";c=a.value;return c}}};x=function(){var a;a=[];($("#name").val()===null||$("#name").val()==="")&&a.push("Please Enter Your Name.");($("#payTo").val()===null||$("#payTo").val()==="")&&a.push("Please Enter Who You Would Like To Pay.");($("#payAmount").val()===null||$("#payAmount").val()===0)&&a.push("Please Enter The Amount To Pay.");($("#payFrom").val()===null||$("#payFrom").val()===""||$("#payFrom").val()==="-- Choose Account --")&&a.push("Please Enter The Account To Pay From.");($("#payOn").val()===null||$("#payOn").val()==="")&&a.push("Please Enter The Date You Would Like To Make This Payment.");w($("#payOn").val())&&a.push("Please Enter A Valid Date.");return a};w=function(b){var c,d,e,f,g,h,i,j;g=!1;c=/^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/;h=b.match(c);h.length<=0&&(g=!0);d=new Date;i="";i=d.getMonth()+1;f="";f=d.getDate();j="";j=d.getFullYear();e=_.toArray(b.split("-"));if(e[0]<j){g=!0;console.log("Entered Year ="+e[0]+". Current Year ="+j)}if(e[1]<a(i)){g=!0;console.log("Entered Month ="+e[1]+". Current Month ="+a(i))}if(e[2]<a(f)&&e[1]===a(i)){g=!0;console.log("Entered Day ="+e[2]+". Current Day ="+a(f))}return g!==null||g!==""&&_.isBoolean(g)?g:alert("ERROR: Please Try Again.")};t=function(a){a.preventDefault();a.stopPropagation();if($.browser.msie){a.originalEvent.keyCode=0;a.originalEvent.cancelBubble=!0;return a.originalEvent.returnValue=!1}};z=function(){$("#items").css("display","inline-block")};n=function(){$("#items").css("display","none")};y=function(){$("#billForm").css("display","inline")};m=function(){$("#billForm").css("display","none")};this.displayData=function(a,b){var c,d;c=a!==null||a!==""?a:!1;d=b!==null||b!==""?b:!1;d?A.showForm():c?A.showBills():l()?A.showForm():A.showBills()};this.showForm=function(){r(!1);n();y();$("#displayData").text("Display Data");$("#displayData").css("padding","0.65em 15px 0.6em 15px")};this.showBills=function(){r(!0);m();z();if(i()===!1||k()){e();h();p(!0);q(!1)}$("#displayData").text("Display Form");$("#displayData").css("padding","0.65em 15px 0.6em 15px")};v=function(){return $(document).unbind("click")};$(document).bind("mobileinit",function(){$.mobile.accounts=g;$.mobile.date=c});g=function(){var a,c,d,e,f,g;c=document.getElementById("selectAccounts");e=document.createElement("select");e.setAttribute("id","payFrom");for(f=0,g=b.length;f<g;f++){a=b[f];d=document.createElement("option");d.setAttribute("value",a);d.innerHTML=a;e.appendChild(d)}c.appendChild(e)};c=function(){var b,c,d,e,f;b=new Date;d=b.getMonth()+1;c=b.getDate();f=b.getFullYear();e=f+"-"+a(d)+"-"+a(c);return document.getElementById("payOn").value=e}})).call(this);